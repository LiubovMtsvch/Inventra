@model List<CourseProjectitr.Models.Inventory>

@{
    ViewData["Title"] = "Welcome";
    var query = Context.Request.Query["query"].ToString();
     var username = Context.Session.GetString("CurrentUserName") ?? User.Identity?.Name ?? "Гость";
}


<div class="auth-container">
    <h1>Welcome to Inventra</h1>
    <p class="tagline">Create your account to get started!</p>

    <div class="social-login mb-4">
        <a href="/Login/Login" class="social-btn" style="text-decoration: none">
            <span class="social-icon google-icon"></span>
            <span>Continue with Google</span>
        </a>

        <a href="/LoginGitHub/signin" class="social-btn" style="text-decoration: none">
            <span class="social-icon github-icon"></span>
            <span>Continue with GitHub</span>
        </a>
    </div>
</div>

@if (Model != null && Model.Any())
{
    var filtered = Model.Where(i =>
        i.IsPublic &&
        (string.IsNullOrWhiteSpace(query) ||
         (!string.IsNullOrEmpty(i.Title) && i.Title.Contains(query, StringComparison.OrdinalIgnoreCase)) ||
         (!string.IsNullOrEmpty(i.Category) && i.Category.Contains(query, StringComparison.OrdinalIgnoreCase)) ||
         (i.Tags != null && i.Tags.Any(t => t.Name.Contains(query, StringComparison.OrdinalIgnoreCase)))
        )
    ).ToList();


    if (filtered.Any())
    {
        <table class="table-clean table table-bordered table-striped table-hover align-middle text-start">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Category</th>
                    <th>Tags</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var inv in filtered)
                {
                    <tr>
                        <td>@inv.NumberPrefix</td>
                        <td>
                            <a asp-action="DetailsForAll" asp-controller="Inventory" asp-route-id="@inv.Id" class="text-decoration-none fw-semibold">
                                @inv.Title
                            </a>
                        </td>
                        <td>@inv.Category</td>
                        <td>
                            @if (inv.Tags != null && inv.Tags.Any())
                            {
                                foreach (var tag in inv.Tags)
                                {
                                    <a href="/Home/Index?query=@tag.Name" class="tag-pill">@tag.Name</a>
                                }
                            }
                            else
                            {
                                <span class="text-muted">No tags</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    
}


@section Styles {
    <style>
        .section-heading {
            font-size: 20px;
            font-weight: 500;
            color: #6c757d;
            margin-bottom: 12px;
            text-align: center;
            letter-spacing: 0.2px;
        }

        .tag-pill {
            display: inline-block;
            background-color: #e0e0e0;
            color: #333;
            padding: 4px 8px;
            margin: 2px;
            border-radius: 12px;
            font-size: 0.85rem;
            text-decoration: none;
            transition: background-color 0.2s ease;
        }

            .tag-pill:hover {
                background-color: #d0d0d0;
            }
    </style>
}
